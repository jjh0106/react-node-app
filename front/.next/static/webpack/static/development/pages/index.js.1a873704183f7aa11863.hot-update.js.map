{"version":3,"file":"static/webpack/static/development/pages/index.js.1a873704183f7aa11863.hot-update.js","sources":["webpack:///./components/PostCard.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\nimport Link from 'next/link';\nimport { Card, Icon, Button, Avatar, List, Form, Input, Comment } from 'antd';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ADD_COMMENT_REQUEST } from '../reducers/post';\n\nconst PostCard = ({ post }) => {\n    const [commentFormOpened, setCommentFormOpened] = useState(false);\n    const [commentText, setCommentText] = useState(''); \n    const { me } = useSelector(state => state.user);\n    const { commentAdded, isAddingComment } = useSelector(state => state.post);\n    const dispatch = useDispatch();\n\n    const onSubmitComment = useCallback((e) => {\n        e.preventDefault();\n        if( !me ){\n            return alert('댓글 입력을 위해서는 로그인을 해주세요.');\n        }\n        return dispatch({\n            type: ADD_COMMENT_REQUEST,\n            data: {\n                postId: post.id,\n            }\n        })\n    }, [me && me.id]);\n\n    const onChangeCommentText = useCallback((e) => {\n        const { value } = e.target;\n        setCommentText(value);\n    }, []);\n\n    const onToggleComment = useCallback(() => {\n        setCommentFormOpened(prev => !prev);\n    }, []);\n\n    useEffect(() => {\n        setCommentText('');\n    }, [commentAdded === true])\n\n    return (\n        <div>\n            <Card\n            key={+post.createdAt}\n            cover={post.img && <img alt=\"example\" src={post.img} />}\n            actions={[\n                <Icon type=\"retweet\" key=\"retweet\" />,\n                <Icon type=\"heart\" key=\"heart\" />,\n                <Icon type=\"message\" key=\"message\" onClick={onToggleComment} />,\n                <Icon type=\"ellipsis\" key=\"ellipsis\" />,\n            ]}\n            extra={<Button>Follow</Button>}\n            >\n                <Card.Meta \n                    avatar={<Link href={{ pathname: '/user', query: { id: post.User.id } }}><a><Avatar>{post.User.nickname[0]}</Avatar></a></Link>}\n                    title={post.User.nickname}\n                    description={(\n                        <div>\n                            {post.content.split(/(#[^\\s]+)/g).map((v) => {\n                                if( v.match(/#[^\\s]+/) ){\n                                    return (\n                                        <Link href=\"/hashtag\" key={v}><a>{v}</a></Link>\n                                    );\n                                }\n                                return v;\n                            })}\n                        </div>\n                    )}\n                />\n            </Card>\n            {commentFormOpened && (\n            <>\n                <Form onSubmit={onSubmitComment}>\n                    <Form.Item>\n                        <Input.TextArea row={4} value={commentText} onChange={onChangeCommentText} />\n                    </Form.Item>\n                    <Button type=\"primary\" htmlType=\"submit\" loading={isAddingComment}>삐약</Button>\n                </Form>\n                <List \n                    header={`${post.Comments ? post.Comments.length : 0}개의 댓글`}\n                    itemLayout=\"horizontal\"\n                    dataSource={post.Comments || []}\n                    renderItem={item => (\n                        <li>\n                            <Comment \n                                author={item.User.nickname}\n                                avatar={<Link href={{ pathname: '/user', query: { id: post.User.id } }}><a><Avatar>{item.User.nickname[0]}</Avatar></a></Link>}\n                                content={item.content}\n                            />\n                        </li>\n                    )}\n                />\n            </>\n            )}\n        </div>\n    );\n};\n\nPostCard.propTypes = {\n    post: PropTypes.shape({\n        User: PropTypes.object,\n        content: PropTypes.string,\n        img: PropTypes.string,\n        createdAt: PropTypes.object,\n    }),\n};\n\nexport default PostCard;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAGA;AAAA;AAHA;AACA;AADA;AAIA;AAAA;AAJA;AAAA;AACA;AAIA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AADA;AAFA;AAMA;AAEA;AAAA;AAEA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAEA;AAGA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AATA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAGA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AAZA;AAmBA;AAAA;AAEA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAHA;AAFA;AAJA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AADA;AASA;;;;A","sourceRoot":""}